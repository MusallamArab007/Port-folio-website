<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Product Table - Sort & Filter</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  body {
    background-color: #f8f9fa;
  }
  th {
    cursor: pointer;
    user-select: none;
  }
  th:hover {
    background-color: #e9ecef;
  }
  .sort-arrow {
    font-size: 14px;
    margin-left: 5px;
    color: #6c757d;
  }
</style>
</head>
<body class="p-4">

<div class="container mt-4">
  <h2 class="text-center mb-4"> Product List</h2>

  <div class="row mb-3 justify-content-center">
    <div class="col-md-4 col-sm-12 mb-2">
      <input type="text" id="searchInput" class="form-control" placeholder=" Search by Product Name...">
    </div>
    <div class="col-md-3 col-sm-12 mb-2">
      <select id="categoryFilter" class="form-select">
        <option value="">All Categories</option>
        <option value="Electronics">Electronics</option>
        <option value="Clothing">Clothing</option>
        <option value="Grocery">Grocery</option>
      </select>
    </div>
    <div class="col-md-2 col-sm-12 mb-2">
      <button class="btn btn-secondary w-100" id="resetFilters">Reset</button>
    </div>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle" id="productTable">
      <thead class="table-primary">
        <tr>
          <th scope="col" onclick="sortTable(0)" aria-sort="none">Product Name </th>
          <th scope="col" onclick="sortTable(1)" aria-sort="none">Price </th>
          <th scope="col" onclick="sortTable(2)" aria-sort="none">Category </th>
        </tr>
      </thead>
      <tbody class="table-light">
        <tr><td>Smartphone</td><td>25000</td><td>Electronics</td></tr>
        <tr><td>T-Shirt</td><td>700</td><td>Clothing</td></tr>
        <tr><td>Rice Bag</td><td>1200</td><td>Grocery</td></tr>
        <tr><td>Headphones</td><td>1500</td><td>Electronics</td></tr>
        <tr><td>Jeans</td><td>2000</td><td>Clothing</td></tr>
        <tr><td>Milk Pack</td><td>60</td><td>Grocery</td></tr>
      </tbody>
    </table>
  </div>
</div>

<script>
let currentSortColumn = null;
let sortDirection = true; // true = ascending, false = descending

function sortTable(columnIndex) {
  const table = document.getElementById("productTable");
  const tbody = table.tBodies[0];
  const rows = Array.from(tbody.rows);

  document.querySelectorAll(".sort-arrow").forEach(a => a.textContent = "⬍");
  document.querySelectorAll("th").forEach(th => th.setAttribute("aria-sort", "none"));

  // Toggle direction if same column clicked
  if (currentSortColumn === columnIndex) {
    sortDirection = !sortDirection;
  } else {
    sortDirection = true;
    currentSortColumn = columnIndex;
  }

  rows.sort((a, b) => {
    let valA = a.cells[columnIndex].innerText.toLowerCase();
    let valB = b.cells[columnIndex].innerText.toLowerCase();

    if (!isNaN(valA) && !isNaN(valB)) {
      valA = Number(valA);
      valB = Number(valB);
    }

    if (valA < valB) return sortDirection ? -1 : 1;
    if (valA > valB) return sortDirection ? 1 : -1;
    return 0;
  });

  tbody.innerHTML = "";
  rows.forEach(row => tbody.appendChild(row));

  const activeArrow = document.querySelectorAll(".sort-arrow")[columnIndex];
  activeArrow.textContent = sortDirection ? "⬆" : "⬇";
  document.querySelectorAll("th")[columnIndex].setAttribute("aria-sort", sortDirection ? "ascending" : "descending");
}

let debounceTimer;
document.getElementById("searchInput").addEventListener("keyup", () => {
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(filterTable, 200);
});
document.getElementById("categoryFilter").addEventListener("change", filterTable);

function filterTable() {
  const searchValue = document.getElementById("searchInput").value.toLowerCase().trim();
  const categoryValue = document.getElementById("categoryFilter").value.toLowerCase();
  const rows = document.querySelectorAll("#productTable tbody tr");

  rows.forEach(row => {
    const name = row.cells[0].innerText.toLowerCase();
    const category = row.cells[2].innerText.toLowerCase();

    const matchesSearch = name.includes(searchValue);
    const matchesCategory = categoryValue === "" || category === categoryValue;

    row.style.display = matchesSearch && matchesCategory ? "" : "none";
  });
}

document.getElementById("resetFilters").addEventListener("click", () => {
  document.getElementById("searchInput").value = "";
  document.getElementById("categoryFilter").value = "";
  filterTable();

  document.querySelectorAll(".sort-arrow").forEach(a => a.textContent = "⬍");
  document.querySelectorAll("th").forEach(th => th.setAttribute("aria-sort", "none"));
  currentSortColumn = null;
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
